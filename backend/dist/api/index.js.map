{"version":3,"sources":["../../src/api/index.js"],"names":["config","db","api","use","get","req","res","json","version","axios","result","data","blocks","console","log","params","hash","tx","map","item","index","id"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;AACA;;;;;;;;kBAEe,gBAAoB;AAAA,KAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,KAATC,EAAS,QAATA,EAAS;;AAClC,KAAIC,MAAM,sBAAV;;AAEA;AACAA,KAAIC,GAAJ,CAAQ,SAAR,EAAmB,sBAAO,EAAEH,cAAF,EAAUC,MAAV,EAAP,CAAnB;;AAEA;AACAC,KAAIE,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIC,IAAJ,CAAS,EAAEC,yBAAF,EAAT;AACA,EAFD;;AAIAN,KAAIE,GAAJ,CAAQ,OAAR;AAAA,sEAAiB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAEIG,gBAAML,GAAN,CAAU,4CAAV,CAFJ;;AAAA;AAEXM,aAFW;;AAGfJ,WAAIC,IAAJ,CAASG,OAAOC,IAAP,CAAYC,MAArB;AAHe;AAAA;;AAAA;AAAA;AAAA;;AAKfC,eAAQC,GAAR;;AALe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA;;AASAZ,KAAIE,GAAJ,CAAQ,eAAR;AAAA,sEAAyB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAEJG,gBAAML,GAAN,uCAA8CC,IAAIU,MAAJ,CAAWC,IAAzD,CAFI;;AAAA;AAEnBN,aAFmB;;AAGvBA,cAAOC,IAAP,CAAYM,EAAZ,GAAiBP,OAAOC,IAAP,CAAYM,EAAZ,CAAeC,GAAf,CAAmB,UAACC,IAAD,EAAOC,KAAP,EAAiB;AACpDD,aAAKE,EAAL,GAAUD,KAAV;AACA,eAAOD,IAAP;AACA,QAHgB,CAAjB;AAIAb,WAAIC,IAAJ,CAASG,OAAOC,IAAhB;AAPuB;AAAA;;AAAA;AAAA;AAAA;;AASvBE,eAAQC,GAAR;;AATuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAzB;;AAAA;AAAA;AAAA;AAAA;;AAaAZ,KAAIE,GAAJ,CAAQ,kBAAR;AAAA,sEAA4B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAEPG,gBAAML,GAAN,oCAA2CC,IAAIU,MAAJ,CAAWE,EAAtD,CAFO;;AAAA;AAEtBP,aAFsB;;AAG1BJ,WAAIC,IAAJ,CAASG,OAAOC,IAAhB;AAH0B;AAAA;;AAAA;AAAA;AAAA;;AAK1BE,eAAQC,GAAR;;AAL0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA5B;;AAAA;AAAA;AAAA;AAAA;;AASA,QAAOZ,GAAP;AACA,C","file":"index.js","sourcesContent":["import { version } from '../../package.json';\nimport { Router } from 'express';\nimport axios from 'axios';\nimport facets from './facets';\n\nexport default ({ config, db }) => {\n\tlet api = Router();\n\n\t// mount the facets resource\n\tapi.use('/facets', facets({ config, db }));\n\n\t// perhaps expose some API metadata at the root\n\tapi.get('/', (req, res) => {\n\t\tres.json({ version });\n\t});\n\n\tapi.get('/list', async (req, res) => {\n\t\ttry {\n\t\t\tlet result = await axios.get('https://blockchain.info/blocks?format=json');\n\t\t\tres.json(result.data.blocks);\n\t\t}catch(e) {\n\t\t\tconsole.log(e);\n\t\t}\n\t});\n\n\tapi.get('/detail/:hash', async (req, res) => {\n\t\ttry {\n\t\t\tlet result = await axios.get(`https://blockchain.info/rawblock/${req.params.hash}`);\n\t\t\tresult.data.tx = result.data.tx.map((item, index) => {\n\t\t\t\titem.id = index;\n\t\t\t\treturn item;\n\t\t\t})\n\t\t\tres.json(result.data);\n\t\t}catch(e) {\n\t\t\tconsole.log(e);\n\t\t}\n\t});\n\n\tapi.get(\"/transaction/:tx\", async( req, res) => {\n\t\ttry {\n\t\t\tlet result = await axios.get(`https://blockchain.info/rawtx/${req.params.tx}`);\n\t\t\tres.json(result.data);\n\t\t}catch(e) {\n\t\t\tconsole.log(e);\n\t\t}\n\t})\n\n\treturn api;\n}\n"]}